SELECT DEPTNO FROM EMP;
SELECT COUNT(*) FROM EMP;

SELECT DEPTNO, COUNT(*) FROM EMP
GROUP BY DEPTNO;

SELECT ENAME, COUNT(*) FROM EMP
GROUP BY ENAME;

SELECT JOB, COUNT(*) FROM EMP
GROUP BY JOB;

SELECT JOB, DEPTNO, MAX(SAL), MIN(SAL) FROM EMP
GROUP BY JOB, DEPTNO;

SELECT DEPTNO, COUNT(*) FROM EMP
GROUP BY DEPTNO
HAVING COUNT(*) > 3;

SELECT DEPTNO, JOB, AVG(SAL) FROM EMP
WHERE SAL <= 3000
GROUP BY DEPTNO, JOB
HAVING AVG(SAL) >= 2000
ORDER BY DEPTNO;

SELECT * FROM EMP;
SELECT DEPTNO, JOB, MAX(SAL) FROM EMP
GROUP BY DEPTNO, JOB;

SELECT * FROM EMP;
SELECT * FROM DEPT;

--JOIN
SELECT E.EMPNO, D.DEPTNO
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO;

SELECT E.EMPNO, E.ENAME, D.DNAME, D.LOC
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO;

SELECT * FROM EMP;
SELECT * FROM SALGRADE;

--비등가 조인
SELECT * 
FROM EMP E, SALGRADE S;

SELECT * 
FROM EMP E, SALGRADE S
WHERE E.SAL BETWEEN S.LOSAL AND S.HISAL;

--자체 조인
--실습 8-8
SELECT E1.EMPNO, E1.ENAME, E1.MGR, E2.EMPNO, E2.ENAME AS "매니저"
FROM EMP E1, EMP E2
WHERE E1.MGR = E2.MGR;

--자체 JOIN 같은 감독의 다른 영화를 찾아주세요.
--영화제목, 감독
SELECT M1.TITLE, M1.DIRECTOR
FROM MOVIES M1, MOVIES M2
WHERE M1.DIRECTOR = M2.DIRECTOR;

--등가JOIN
SELECT E1.EMPNO, E1.ENAME, E1.MGR, E2.EMPNO, E2.ENAME
FROM EMP E1, EMP E2
WHERE E1.MGR = E2.MGR;

--LEFT OUTER JOIN
SELECT E1.EMPNO, E1.ENAME, E1.MGR, E2.EMPNO, E2.ENAME
FROM EMP E1, EMP E2
WHERE E1.MGR = E2.EMPNO(+);

--RIGHT OUTER JOIN
SELECT E1.EMPNO, E1.ENAME, E1.MGR, E2.EMPNO, E2.ENAME
FROM EMP E1, EMP E2
WHERE E1.MGR(+) = E2.EMPNO;

--[SQL99]NATURAL JOIN
SELECT * 
FROM EMP E NATURAL JOIN DEPT D;

SELECT E.ENAME, DEPTNO, D.DNAME 
FROM EMP E NATURAL JOIN DEPT D;

SELECT * FROM EMP;
SELECT * FROM DEPT;

--[SQL99]JOIN ~ USING
SELECT E.ENAME, DEPTNO, D.DNAME
FROM EMP E JOIN DEPT D USING (DEPTNO);

--[SQL99] JOIN ~ ON 
SELECT *
FROM EMP E JOIN DEPT D ON (E.DEPTNO = D.DEPTNO);

--[SQL99] LEFT OUTER JOIN
SELECT E1.EMPNO, E1.ENAME, E1.MGR,
       E2.EMPNO AS MGR_EMPNO, 
       E2.ENAME AS MGR_ENAME
FROM EMP E1 LEFT OUTER JOIN EMP E2 ON (E1.MGR = E2.EMPNO)
ORDER BY E1.EMPNO;

--P239 연습문제1234
--1
SELECT D.DEPTNO, D.DNAME, E.EMPNO, E.ENAME, E.SAL
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO
AND E.SAL > 2000;

--1[SQL-99]
SELECT DEPTNO, DNAME, EMPNO, ENAME, SAL
FROM EMP NATURAL JOIN DEPT
WHERE SAL > 2000;


SELECT DEPTNO, D.DNAME, E.EMPNO, E.ENAME, E.SAL
FROM EMP E JOIN DEPT D USING (DEPTNO)
WHERE E.SAL > 2000;

SELECT D.DEPTNO, D.DNAME, E.EMPNO, E.ENAME, E.SAL
FROM EMP E JOIN DEPT D ON(E.DEPTNO = D.DEPTNO)
WHERE E.SAL > 2000;

--2
SELECT DEPTNO, DNAME, ROUND(AVG(SAL),2), MAX(SAL), MIN(SAL), COUNT(SAL)
FROM EMP NATURAL JOIN DEPT
GROUP BY DEPTNO, DNAME;

--3

--사원이름이 'JONES' 사원의 급여는?

SELECT SAL FROM EMP
WHERE ENAME = 'JONES';

SELECT * FROM EMP
WHERE SAL > 2975;

SELECT * FROM EMP
WHERE SAL > (SELECT SAL FROM EMP
WHERE ENAME = 'JONES');

SELECT COMM FROM EMP
WHERE ENAME = 'ALLEN';
SELECT * FROM MOVIES;

SELECT ENAME FROM EMP
WHERE COMM > (SELECT COMM FROM EMP
WHERE ENAME = 'ALLEN');

SELECT TITLE FROM MOVIES
WHERE (GENRE = '드라마' AND SUBSTR(RELEASE_DATE,1,2) = '15');

SELECT ROUND(AVG(SAL),2) FROM EMP;

SELECT AVG(SAL) FROM EMP;

SELECT E.EMPNO, E.ENAME, E.JOB, E.SAL, D.DEPTNO, D.DNAME, D.LOC
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO
AND E.DEPTNO = 20
AND E.SAL > (SELECT AVG(SAL) FROM EMP);

SELECT * FROM EMP;
SELECT * FROM DEPT;
SELECT ENAME

--IN
SELECT * FROM EMP
WHERE DEPTNO IN (20, 30);

--ANY
SELECT * FROM EMP
WHERE SAL = ANY (SELECT MAX(SAL) FROM EMP GROUP BY DEPTNO);

--ALL
SELECT * FROM EMP
WHERE SAL > ALL (SELECT SAL FROM EMP WHERE DEPTNO = 30);

CREATE TABLE DEPT_TEMP 
    AS SELECT * FROM DEPT;

SELECT * FROM DEPT_TEMP;
--삽입
INSERT INTO DEPT_TEMP (DEPTNO, DNAME, LOC)
VALUES (50, 'DATABASE', 'SEOUL');

INSERT INTO DEPT_TEMP (DEPTNO, DNAME, LOC)
VALUES (60, '설계', '대구');

INSERT INTO DEPT_TEMP (DEPTNO, DNAME, LOC)
VALUES (70, '회로설계', '구미');

INSERT INTO DEPT_TEMP (DEPTNO, DNAME, LOC)
VALUES (80, '철강구매', NULL);

DESC DEPT_TEMP;
--저장
COMMIT;

--P272
CREATE TABLE EMP_TEMP
AS SELECT * FROM EMP WHERE 1 <> 1;

SELECT * FROM EMP_TEMP;

--10-9 INSERT 문으로 날짜 데이터 입력하기
INSERT INTO EMP_TEMP
VALUES (999, '홍길동', '대표', NULL, '2001/01/01', 5000, 1000, 10);
--10-10
INSERT INTO EMP_TEMP
VALUES (1111, '성춘향', '매니저', 9999, '2001/01/05', 4000, NULL, 20);
--10-12 TO_DATE
--10-13
--10-14 SUBQUERY

--수정 UPDATE
--10-15
CREATE TABLE DEPT_TEMP2
AS SELECT * FROM DEPT;

SELECT * FROM DEPT_TEMP2;
COMMIT;
--10-6 UPDATE
UPDATE DEPT_TEMP2
SET LOC = 'SEOUL'
WHERE DEPTNO = 10;

ROLLBACK;

--실습 10-18 테이블 데이터 중 일부만 수정
SELECT * FROM DEPT_TEMP2;
DESC DEPT_TEMP2;

UPDATE DEPT_TEMP2
SET DNAME = 'DB',
    LOC = '서울'
WHERE DEPTNO = 40;

-- EMP_TEMP 테이블의 사원중에서 급여가 2500이하인 사원만 추가수당(COMM)
-- 50으로 수정해 주세여.
-- 테이블 삭제
DROP TABLE EMP_TEMP;
--테이블 복사 생성
CREATE TABLE EMP_TEMP
AS SELECT * FROM EMP;

SELECT * FROM EMP_TEMP
ORDER BY SAL DESC;

UPDATE EMP_TEMP
SET COMM = 50
WHERE SAL <= 2500;

--
SELECT * FROM EMP_TEMP;

DELETE FROM EMP_TEMP
WHERE ENAME = 'SMITH' AND JOB = 'CLERK'; 

ROLLBACK;
COMMIT;

--ALTER TABLE

CREATE TABLE EMP_ALTER
AS SELECT * FROM EMP;

SELECT * FROM EMP_ALTER;
--컬럼 추가
ALTER TABLE EMP_ALTER
ADD HP VARCHAR2(20);

--컬럼 이름 변경 RENAME COLUMN
ALTER TABLE EMP_ALTER
RENAME COLUMN HP TO TEL;

DESC EMP_ALTER;
--컬럼 TYPE(자료형)을 변경 MODIFY
ALTER TABLE EMP_ALTER
MODIFY EMPNO NUMBER(6);

--컬럼을 삭제 DROP COLUMN
ALTER TABLE EMP_ALTER
DROP COLUMN TEL;

SELECT * FROM EMP_ALTER;
COMMIT;

--테이블의 이름 변경 RENAME
RENAME EMP_ALTER TO EMP_RENAME;

SELECT * FROM EMP_RENAME;

--테이블의 데이터를 삭제 TRUNCATE TABLE
TRUNCATE TABLE EMP_RENAME;

P324 연습문제 1234
