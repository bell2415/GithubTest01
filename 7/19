SELECT DEPTNO FROM EMP;
SELECT COUNT(*) FROM EMP;

SELECT DEPTNO, COUNT(*) FROM EMP
GROUP BY DEPTNO;

SELECT ENAME, COUNT(*) FROM EMP
GROUP BY ENAME;

SELECT JOB, COUNT(*) FROM EMP
GROUP BY JOB;

SELECT JOB, DEPTNO, MAX(SAL), MIN(SAL) FROM EMP
GROUP BY JOB, DEPTNO;

SELECT DEPTNO, COUNT(*) FROM EMP
GROUP BY DEPTNO
HAVING COUNT(*) > 3;

SELECT DEPTNO, JOB, AVG(SAL) FROM EMP
WHERE SAL <= 3000
GROUP BY DEPTNO, JOB
HAVING AVG(SAL) >= 2000
ORDER BY DEPTNO;

SELECT * FROM EMP;
SELECT DEPTNO, JOB, MAX(SAL) FROM EMP
GROUP BY DEPTNO, JOB;

SELECT * FROM EMP;
SELECT * FROM DEPT;

--JOIN
SELECT E.EMPNO, D.DEPTNO
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO;

SELECT E.EMPNO, E.ENAME, D.DNAME, D.LOC
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO;

SELECT * FROM EMP;
SELECT * FROM SALGRADE;

--비등가 조인
SELECT * 
FROM EMP E, SALGRADE S;

SELECT * 
FROM EMP E, SALGRADE S
WHERE E.SAL BETWEEN S.LOSAL AND S.HISAL;

--자체 조인
--실습 8-8
SELECT E1.EMPNO, E1.ENAME, E1.MGR, E2.EMPNO, E2.ENAME AS "매니저"
FROM EMP E1, EMP E2
WHERE E1.MGR = E2.MGR;

--자체 JOIN 같은 감독의 다른 영화를 찾아주세요.
--영화제목, 감독
SELECT M1.TITLE, M1.DIRECTOR
FROM MOVIES M1, MOVIES M2
WHERE M1.DIRECTOR = M2.DIRECTOR;

--등가JOIN
SELECT E1.EMPNO, E1.ENAME, E1.MGR, E2.EMPNO, E2.ENAME
FROM EMP E1, EMP E2
WHERE E1.MGR = E2.MGR;

--LEFT OUTER JOIN
SELECT E1.EMPNO, E1.ENAME, E1.MGR, E2.EMPNO, E2.ENAME
FROM EMP E1, EMP E2
WHERE E1.MGR = E2.EMPNO(+);

--RIGHT OUTER JOIN
SELECT E1.EMPNO, E1.ENAME, E1.MGR, E2.EMPNO, E2.ENAME
FROM EMP E1, EMP E2
WHERE E1.MGR(+) = E2.EMPNO;

--[SQL99]NATURAL JOIN
SELECT * 
FROM EMP E NATURAL JOIN DEPT D;

SELECT E.ENAME, DEPTNO, D.DNAME 
FROM EMP E NATURAL JOIN DEPT D;

SELECT * FROM EMP;
SELECT * FROM DEPT;

--[SQL99]JOIN ~ USING
SELECT E.ENAME, DEPTNO, D.DNAME
FROM EMP E JOIN DEPT D USING (DEPTNO);

--[SQL99] JOIN ~ ON 
SELECT *
FROM EMP E JOIN DEPT D ON (E.DEPTNO = D.DEPTNO);

--[SQL99] LEFT OUTER JOIN
SELECT E1.EMPNO, E1.ENAME, E1.MGR,
       E2.EMPNO AS MGR_EMPNO, 
       E2.ENAME AS MGR_ENAME
FROM EMP E1 LEFT OUTER JOIN EMP E2 ON (E1.MGR = E2.EMPNO)
ORDER BY E1.EMPNO;

--P239 연습문제1234
--1
SELECT D.DEPTNO, D.DNAME, E.EMPNO, E.ENAME, E.SAL
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO
AND E.SAL > 2000;

--1[SQL-99]
SELECT DEPTNO, DNAME, EMPNO, ENAME, SAL
FROM EMP NATURAL JOIN DEPT
WHERE SAL > 2000;


SELECT DEPTNO, D.DNAME, E.EMPNO, E.ENAME, E.SAL
FROM EMP E JOIN DEPT D USING (DEPTNO)
WHERE E.SAL > 2000;

SELECT D.DEPTNO, D.DNAME, E.EMPNO, E.ENAME, E.SAL
FROM EMP E JOIN DEPT D ON(E.DEPTNO = D.DEPTNO)
WHERE E.SAL > 2000;

--2
SELECT DEPTNO, DNAME, ROUND(AVG(SAL),2), MAX(SAL), MIN(SAL), COUNT(SAL)
FROM EMP NATURAL JOIN DEPT
GROUP BY DEPTNO, DNAME;

--3

--사원이름이 'JONES' 사원의 급여는?

SELECT SAL FROM EMP
WHERE ENAME = 'JONES';

SELECT * FROM EMP
WHERE SAL > 2975;

SELECT * FROM EMP
WHERE SAL > (SELECT SAL FROM EMP
WHERE ENAME = 'JONES');

SELECT COMM FROM EMP
WHERE ENAME = 'ALLEN';
SELECT * FROM MOVIES;

SELECT ENAME FROM EMP
WHERE COMM > (SELECT COMM FROM EMP
WHERE ENAME = 'ALLEN');

SELECT TITLE FROM MOVIES
WHERE (GENRE = '드라마' AND SUBSTR(RELEASE_DATE,1,2) = '15');

SELECT ROUND(AVG(SAL),2) FROM EMP;

SELECT AVG(SAL) FROM EMP;

SELECT E.EMPNO, E.ENAME, E.JOB, E.SAL, D.DEPTNO, D.DNAME, D.LOC
FROM EMP E, DEPT D
WHERE E.DEPTNO = D.DEPTNO
AND E.DEPTNO = 20
AND E.SAL > (SELECT AVG(SAL) FROM EMP);

SELECT * FROM EMP;
SELECT * FROM DEPT;
SELECT ENAME
